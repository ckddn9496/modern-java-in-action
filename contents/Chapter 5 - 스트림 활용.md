# Chapter 5 - μ¤νΈλ¦Ό ν™μ©

μ¤νΈλ¦Ό APIκ°€ μ§€μ›ν•λ” λ‹¤μ–‘ν• μ—°μ‚°λ“¤μ„ μ‚΄ν΄λ³΄μ.

## 1. ν•„ν„°λ§

- filter - Predicateλ¥Ό ν†µν• ν•„ν„°λ§

```java
Stream<T> filter(Predicate<? super T> predicate);
```

- distinct - κ³ μ  μ”μ†λ§ ν•„ν„°λ§

```java
Stream<T> distinct();
```

## 2. μ¤νΈλ¦Ό μ¬λΌμ΄μ‹±

### Predicateλ¥Ό ν†µν• μ¬λΌμ΄μ‹±

- takeWhile - Predicateμ κ²°κ³Όκ°€ trueμΈ μ”μ†μ— λ€ν• ν•„ν„°λ§. Predicateμ΄ μ²μμΌλ΅ κ±°μ§“μ΄ λλ” μ§€μ μ— μ—°μ‚°μ„ λ©μ¶λ‹¤.

```java
Stream<T> takeWhile(Predicate<? super T> predicate)
```

- dropWhile - Predicateμ κ²°κ³Όκ°€ falseμΈ μ”μ†μ— λ€ν• ν•„ν„°λ§. Predicateμ΄ μ²μμΌλ΅ κ±°μ§“μ΄ λλ” μ§€μ κΉμ§€ λ°κ²¬λ μ”μ†λ¥Ό λ²„λ¦°λ‹¤.

```java
Stream<T> dropWhile(Predicate<? super T> predicate)
```

### μ¤νΈλ¦Ό μ¶•μ†

- limit - μ£Όμ–΄μ§„ κ°’ μ΄ν•μ ν¬κΈ°λ¥Ό κ°–λ” μƒλ΅μ΄ μ¤νΈλ¦Όμ„ λ°ν™ν•λ‹¤.

```java
Stream<T> limit(long maxSize);
```

### μ”μ† κ±΄λ„λ›°κΈ°

- skip - μ²μ nκ° μ”μ†λ¥Ό μ μ™Έν• μ¤νΈλ¦Όμ„ λ°ν™ν•λ‹¤.

```java
Stream<T> skip(long n);
```

## 3. λ§¤ν•‘

### μ¤νΈλ¦Όμ κ° μ”μ†μ— ν•¨μ μ μ©ν•κΈ°

- map - ν•¨μλ¥Ό μΈμλ΅ λ°›μ•„ μƒλ΅μ΄ μ”μ†λ΅ λ§¤ν•‘λ μ¤νΈλ¦Όμ„ λ°ν™ν•λ‹¤. κΈ°λ³Έν• μ”μ†μ— λ€ν• mapTo*Type* λ©”μ„λ“λ„ μ§€μ›ν•λ‹¤ (mapToInt, mapToLong, mapToDouble).

```java
<R> Stream<R> map(Function<? super T, ? extends R> mapper);
```

### μ¤νΈλ¦Ό ν‰λ©΄ν™”

- flatMap - μ κ³µλ ν•¨μλ¥Ό κ° μ”μ†μ— μ μ©ν•μ—¬ μƒλ΅μ΄ ν•λ‚μ μ¤νΈλ¦ΌμΌλ΅ λ§¤ν•‘ν•λ‹¤. κ²°κ³Όμ μΌλ΅ ν•λ‚μ ν‰λ©΄ν™”λ μ¤νΈλ¦Όμ„ λ°ν™ν•λ‹¤.

```java
<R> Stream<R> flatMap(Function<? super T, ? extends Stream<? extends R>> mapper);
```

## 4. κ²€μƒ‰κ³Ό λ§¤μΉ­ (μ‡ΌνΈ μ„ν‚·)

- anyMatch - μ μ–΄λ„ ν• μ”μ†μ™€ μΌμΉν•λ”μ§€ ν™•μΈν•λ” μµμΆ… μ—°μ‚°μ΄λ‹¤ (μΌμΉν•λ” μκ°„ true λ°ν™).

```java
boolean anyMatch(Predicate<? super T> predicate);
```

- allMatch - λ¨λ“  μ”μ†μ™€ μΌμΉν•λ”μ§€ κ²€μ‚¬ν•λ” μµμΆ… μ—°μ‚°μ΄λ‹¤ (μΌμΉν•μ§€ μ•λ” μκ°„ false λ°ν™).

```java
boolean allMatch(Predicate<? super T> predicate);
```

- noneMatch - λ¨λ“  μ”μ†κ°€ μΌμΉν•μ§€ μ•λ”μ§€ κ²€μ‚¬ν•λ” μµμΆ… μ—°μ‚°μ΄λ‹¤ (μΌμΉν•λ” μκ°„ false λ°ν™).

```java
boolean noneMatch(Predicate<? super T> predicate);
```

- findFirst - μ²« λ²μ§Έ μ”μ†λ¥Ό μ°Ύμ•„ λ°ν™ν•λ‹¤. μμ„κ°€ μ •ν•΄μ Έ μμ„ λ• μ‚¬μ©ν•λ‹¤.

```java
Optional<T> findFirst();
```

- findAny - μ”μ†λ¥Ό μ°ΎμΌλ©΄ λ°ν™ν•λ‹¤. μ”μ†μ λ°ν™μμ„κ°€ μƒκ΄€μ—†μ„ λ• findFirst λ€μ‹  μ‚¬μ©λλ‹¤.

```java
Optional<T> findAny();
```

## 5. λ¦¬λ“€μ‹±

- reduce - λ¨λ“  μ¤νΈλ¦Ό μ”μ†λ¥Ό BinaryOperatorλ΅ μ²λ¦¬ν•΄μ„ κ°’μΌλ΅ λ„μ¶ν•λ‹¤. λ‘ λ²μ§Έ reduce λ©”μ„λ“μ™€ κ°™μ€ κ²½μ° μ΄κΈ°κ°’(identity)κ°€ μ—†μΌλ―€λ΅ μ•„λ¬΄ μ”μ†κ°€ μ—†μ„ λ•λ¥Ό μ„ν•΄ `Optional<T>`λ¥Ό λ°ν™ν•λ‹¤.

```java
T reduce(T identity, BinaryOperator<T> accumulator);
Optional<T> reduce(BinaryOperator<T> accumulator);
<U> U reduce(U identity, BiFunction<U, ? super T, U> accumulator, BinaryOperator<U> combiner);
```

- max, min - μ”μ†μ—μ„ μµλ“κ°’κ³Ό μµμ†κ°’μ„ λ°ν™ν•λ‹¤. λ§μ°¬κ°€μ§€λ΅, λΉ μ¤νΈλ¦ΌμΌ μ μκΈ°μ— `Optional<T>` λ¥Ό λ°ν™ν•λ‹¤.

```java
Optional<T> max(Comparator<? super T> comparator);
Optional<T> min(Comparator<? super T> comparator);
```

> π’΅ **reduce λ©”μ„λ“μ μ¥μ κ³Ό λ³‘λ ¬ν™”**
> 
> κΈ°μ΅΄μ λ‹¨κ³„μ  λ°λ³µμΌλ΅ ν•©κ³„λ¥Ό κµ¬ν•λ” κ²ƒλ³΄λ‹¤ reduceλ¥Ό μ΄μ©ν•λ©΄ λ‚΄λ¶€ λ°λ³µμ΄ μ¶”μƒν™”λλ©΄μ„ λ‚΄λ¶€ κµ¬ν„μ—μ„ λ³‘λ ¬λ΅ reduceλ¥Ό μ‹¤ν–‰ν•  μ μκ² λλ‹¤. λ°λ³µμ μΈ ν•©κ³„μ—μ„λ” sum λ³€μλ¥Ό κ³µμ ν•΄μ•Ό ν•λ―€λ΅ μ‰½κ² λ³‘λ ¬ν™”ν•κΈ° μ–΄λ µλ‹¤. μ¤νΈλ¦Όμ€ λ‚΄λ¶€μ μΌλ΅ ν¬ν¬/μ΅°μΈ ν”„λ μ„μ›ν¬(fork/join framework)λ¥Ό ν†µν•΄ μ΄λ¥Ό μ²λ¦¬ν•λ‹¤.

***

> π’΅ **μ¤νΈλ¦Ό μ—°μ‚° : μƒνƒ μ—†μκ³Ό μƒνƒ μμ**
> 
> κ°κ°μ μ¤νΈλ¦Ό μ—°μ‚°μ€ μƒνƒλ¥Ό κ°–λ” μ—°μ‚°κ³Ό μƒνƒλ¥Ό κ°–μ§€ μ•λ” μ—°μ‚°μΌλ΅ λ‚λ‰μ–΄μ Έ μλ‹¤.
> 
> map, filter λ“±μ€ μ…λ ¥ μ¤νΈλ¦Όμ—μ„ κ° μ”μ†λ¥Ό λ°›μ•„ 0 λλ” κ²°κ³Όλ¥Ό μ¶λ ¥ μ¤νΈλ¦ΌμΌλ΅ λ³΄λ‚Έλ‹¤. λ”°λΌμ„ μ΄λ“¤μ€ λ³΄ν†µ μƒνƒκ°€ μ—†λ”, <strong>λ‚΄λ¶€ μƒνƒλ¥Ό κ°–μ§€ μ•λ” μ—°μ‚°(stateless operation)</strong>μ΄λ‹¤.
> 
> ν•μ§€λ§ reduce, sum, max κ°™μ€ μ—°μ‚°μ€ κ²°κ³Όλ¥Ό λ„μ ν•  λ‚΄λ¶€ μƒνƒκ°€ ν•„μ”ν•λ‹¤. μμ μ λ‚΄λ¶€ μƒνƒλ” μ‘μ€ κ°’μ΄λ‹¤. μ¤νΈλ¦Όμ—μ„ μ²λ¦¬ν•λ” μ”μ† μμ™€ κ΄€κ³„μ—†μ΄ λ‚΄λ¶€ μƒνƒμ ν¬κΈ°λ” <strong>ν•μ •(bounded)</strong>λμ–΄ μλ‹¤.
> 
> λ°λ©΄ sortedλ‚ distinct κ°™μ€ μ—°μ‚°μ€ μ¤νΈλ¦Όμ μ”μ†λ¥Ό μ •λ ¬ν•κ±°λ‚ μ¤‘λ³µμ„ μ κ±°ν•κΈ° μ„ν•΄ κ³Όκ±°μ μ΄λ ¥μ„ μ•κ³  μμ–΄μ•Ό ν•λ‹¤. μλ¥Ό λ“¤μ–΄ μ–΄λ–¤ μ”μ†λ¥Ό μ¶λ ¥ μ¤νΈλ¦ΌμΌλ΅ μ¶”κ°€ν•λ ¤λ©΄ <strong>λ¨λ“  μ”μ†κ°€ λ²„νΌμ— μ¶”κ°€λμ–΄ μμ–΄μ•Ό ν•λ‹¤</strong>. λ”°λΌμ„ λ°μ΄ν„° μ¤νΈλ¦Όμ ν¬κΈ°κ°€ ν¬κ±°λ‚ λ¬΄ν•μ΄λΌλ©΄ λ¬Έμ κ°€ μƒκΈΈ μ μλ‹¤. μ΄λ¬ν• μ—°μ‚°μ„ <strong>λ‚΄λ¶€ μƒνƒλ¥Ό κ°–λ” μ—°μ‚°(stateful operation)</strong>μ΄λΌ ν•λ‹¤.

***

## 6. μ«μν• μ¤νΈλ¦Ό

μ¤νΈλ¦Ό APIλ” μ«μ μ¤νΈλ¦Όμ„ ν¨μ¨μ μΌλ΅ μ²λ¦¬ν•  μ μλ„λ΅ κΈ°λ³Έν• νΉν™” μ¤νΈλ¦Ό(primitive stream specialization)μ„ μ κ³µν•λ‹¤.

### κΈ°λ³Έν• νΉν™” μ¤νΈλ¦Ό

κΈ°λ³Έν• νΉν™” μ¤νΈλ¦ΌμΌλ΅ `IntStream`, `DoubleStream`, `LongStream`μ΄ μ΅΄μ¬ν•λ©° κ°κ°μ μΈν„°νμ΄μ¤μ—λ” μ«μ μ¤νΈλ¦Όμ ν•©κ³„λ¥Ό κ³„μ‚°ν•λ” sum, μµλ“κ°’ μ”μ†λ¥Ό κ²€μƒ‰ν•λ” max κ°™μ΄ μμ£Ό μ‚¬μ©ν•λ” μ«μ κ΄€λ ¨ λ¦¬λ“€μ‹± μ—°μ‚° λ©”μ„λ“λ¥Ό μ κ³µν•λ‹¤.

### κ°μ²΄ μ¤νΈλ¦ΌμΌλ΅ λ³µμ›ν•κΈ°

`boxed`λ©”μ„λ“λ¥Ό μ΄μ©ν•λ©΄ νΉν™” μ¤νΈλ¦Όμ„ μΌλ° μ¤νΈλ¦ΌμΌλ΅ λ³€ν™ν•  μ μλ‹¤.

```java
Stream<Integer> boxed(); // in IntStream
```

Optionalλ„ κΈ°λ³Έν•μ— λ€ν•μ—¬ μ§€μ›ν•λ‹¤. `OptionalInt`, `OptionalDouble`, `optionalLong` μ„Έ κ°€μ§€ κΈ°λ³Έν• νΉν™” μ¤νΈλ¦Ό λ²„μ „μ Optionalμ΄ μ κ³µλλ‹¤.

### μ«μ λ²”μ„

νΉμ • λ²”μ„μ μ«μλ¥Ό μ΄μ©ν•΄μ•Ό ν•  λ• `range`μ™€ `rangeClosed` λ©”μ„λ“λ¥Ό μ‚¬μ©ν•  μ μλ‹¤. μ΄λ” IntStream, LongStream λ‘ κΈ°λ³Έν• νΉν™” μ¤νΈλ¦Όμ—μ„ μ§€μ›λλ‹¤. rangeλ” μ—΄λ¦° κµ¬κ°„μ„ μλ―Έν•λ©°, rangeClosedλ” λ‹«ν κµ¬κ°„μ„ μλ―Έν•λ‹¤.

## 7. μ¤νΈλ¦Ό λ§λ“¤κΈ°

### κ°’μΌλ΅ μ¤νΈλ¦Ό λ§λ“¤κΈ°

μ •μ  λ©”μ„λ“ `Stream.of` μ„ μ΄μ©ν•μ—¬ μ¤νΈλ¦Όμ„ λ§λ“¤ μ μλ‹¤.

### nullμ΄ λ  μ μλ” κ°μ²΄λ΅ μ¤νΈλ¦Ό λ§λ“¤κΈ°

μλ°” 9λ¶€ν„° μ§€μ›λλ©° `Stream.ofNullable` λ©”μ„λ“λ¥Ό μ΄μ©ν•μ—¬ nullμ΄ λ  μ μλ” κ°μ²΄λ¥Ό μ§€μ›ν•λ” μ¤νΈλ¦Όμ„ λ§λ“¤ μ μλ‹¤.

### λ°°μ—΄λ΅ μ¤νΈλ¦Ό λ§λ“¤κΈ°

λ°°μ—΄μ„ μΈμλ΅ λ°›λ” μ •μ  λ©”μ„λ“ `Arrays.stream` μ„ μ΄μ©ν•μ—¬ μ¤νΈλ¦Όμ„ λ§λ“¤ μ μλ‹¤.

### νμΌλ΅ μ¤νΈλ¦Ό λ§λ“¤κΈ°

νμΌμ„ μ²λ¦¬ν•λ” λ“±μ I/O μ—°μ‚°μ— μ‚¬μ©ν•λ” μλ°”μ NIO API(λΉ„λΈ”λ΅ I/O)λ„ μ¤νΈλ¦Ό APIλ¥Ό ν™μ©ν•  μ μλ„λ΅ μ—…λ°μ΄νΈλμ—λ‹¤. java.nio.file.Filesμ λ§μ€ μ •μ  λ©”μ„λ“κ°€ μ¤νΈλ¦Όμ„ λ°ν™ν•λ‹¤. μλ¥Ό λ“¤μ–΄ `Files.lines`λ” μ£Όμ–΄μ§„ νμΌμ ν–‰ μ¤νΈλ¦Όμ„ λ¬Έμμ—΄λ΅ λ°ν™ν•λ‹¤.

### ν•¨μλ΅ λ¬΄ν• μ¤νΈλ¦Ό λ§λ“¤κΈ°

Stream.iterateμ™€ Stream.generateλ¥Ό ν†µν•΄ ν•¨μλ¥Ό μ΄μ©ν•μ—¬ λ¬΄ν• μ¤νΈλ¦Όμ„ λ§λ“¤ μ μλ‹¤. iterateμ™€ generateμ—μ„ λ§λ“  μ¤νΈλ¦Όμ€ μ”μ²­ν•  λ•λ§λ‹¤ μ£Όμ–΄μ§„ ν•¨μλ¥Ό μ΄μ©ν•΄μ„ κ°’μ„ λ§λ“ λ‹¤. λ”°λΌμ„ λ¬΄μ ν•μΌλ΅ κ°’μ„ κ³„μ‚°ν•  μ μμ§€λ§, λ³΄ν†µ λ¬΄ν•ν• κ°’μ„ μ¶λ ¥ν•μ§€ μ•λ„λ΅  limit(n) ν•¨μλ¥Ό ν•¨κ» μ—°κ²°ν•΄μ„ μ‚¬μ©ν•λ‹¤.

- Stream.iterate

```java
public static<T> Stream<T> iterate(final T seed, final UnaryOperator<T> f)
```

- Stream.generate

```java
public static<T> Stream<T> generate(Supplier<T> s)
```